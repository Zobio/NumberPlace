using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace NumberPlace
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox2_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox3_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox4_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox5_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox6_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox7_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox8_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox9_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox10_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox11_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox12_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox13_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox14_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox15_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox16_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox17_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox18_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox19_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox20_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox21_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox22_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox23_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox24_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox25_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox26_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox27_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox28_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox29_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox30_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox31_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox32_TextChanged(object sender, EventArgs e)
        {

        }
        private void textBox33_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox34_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox35_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox36_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox37_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox38_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox39_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox40_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox41_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox42_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox43_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox44_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox45_TextChanged(object sender, EventArgs e)
        {

        }
        private void textBox46_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox47_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox48_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox49_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox50_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox51_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox52_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox53_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox54_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox55_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox56_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox57_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox58_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox59_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox60_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox61_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox62_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox63_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox64_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox65_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox66_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox67_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox68_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox69_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox70_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox71_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox72_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox73_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox74_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox75_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox76_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox77_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox78_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox79_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox80_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox81_TextChanged(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            bool[,] fill = new bool[10, 10];
            int[,] num = new int[10, 10];
            fill = checkFill(fill);
            num = fillNum(fill, num);
            for(int i = 1; i <= 9; i++)
            {
                for(int j = 1;j <= 9; j++) {
                    if(num[i,j] == 10)
                    {
                        MessageBox.Show("エラーが発生しました。\n数字ではない文字列、または1-9以外の数が入力されています。\n"
                             + "\n該当箇所: " + i.ToString() + " , " + j.ToString(), "エラー", MessageBoxButtons.OK, MessageBoxIcon.Error);
                        return;

                    }
                }
            }
            int[,] oldNum = new int[10, 10];
            Array.Copy(num, oldNum, num.Length);
            num = solveNumberPlace(num);
            for(int i = 1; i <= 9; i++)
            {
                for(int j = 1; j <= 9; j++)
                {
                    if (num[i, j] != oldNum[i, j])
                    {
                        showNewNum(i, j, num[i, j]);
                    }

                }
            }
        }

        public bool[,] checkFill(bool[,] fill)
        {
            fill[1, 1] = textBox1_1.Text.Trim().Equals("") ? false : true;
            fill[1, 2] = textBox1_2.Text.Trim().Equals("") ? false : true;
            fill[1, 3] = textBox1_3.Text.Trim().Equals("") ? false : true;
            fill[1, 4] = textBox1_4.Text.Trim().Equals("") ? false : true;
            fill[1, 5] = textBox1_5.Text.Trim().Equals("") ? false : true;
            fill[1, 6] = textBox1_6.Text.Trim().Equals("") ? false : true;
            fill[1, 7] = textBox1_7.Text.Trim().Equals("") ? false : true;
            fill[1, 8] = textBox1_8.Text.Trim().Equals("") ? false : true;
            fill[1, 9] = textBox1_9.Text.Trim().Equals("") ? false : true;
            fill[2, 1] = textBox2_1.Text.Trim().Equals("") ? false : true;
            fill[2, 2] = textBox2_2.Text.Trim().Equals("") ? false : true;
            fill[2, 3] = textBox2_3.Text.Trim().Equals("") ? false : true;
            fill[2, 4] = textBox2_4.Text.Trim().Equals("") ? false : true;
            fill[2, 5] = textBox2_5.Text.Trim().Equals("") ? false : true;
            fill[2, 6] = textBox2_6.Text.Trim().Equals("") ? false : true;
            fill[2, 7] = textBox2_7.Text.Trim().Equals("") ? false : true;
            fill[2, 8] = textBox2_8.Text.Trim().Equals("") ? false : true;
            fill[2, 9] = textBox2_9.Text.Trim().Equals("") ? false : true;
            fill[3, 1] = textBox3_1.Text.Trim().Equals("") ? false : true;
            fill[3, 2] = textBox3_2.Text.Trim().Equals("") ? false : true;
            fill[3, 3] = textBox3_3.Text.Trim().Equals("") ? false : true;
            fill[3, 4] = textBox3_4.Text.Trim().Equals("") ? false : true;
            fill[3, 5] = textBox3_5.Text.Trim().Equals("") ? false : true;
            fill[3, 6] = textBox3_6.Text.Trim().Equals("") ? false : true;
            fill[3, 7] = textBox3_7.Text.Trim().Equals("") ? false : true;
            fill[3, 8] = textBox3_8.Text.Trim().Equals("") ? false : true;
            fill[3, 9] = textBox3_9.Text.Trim().Equals("") ? false : true;
            fill[4, 1] = textBox4_1.Text.Trim().Equals("") ? false : true;
            fill[4, 2] = textBox4_2.Text.Trim().Equals("") ? false : true;
            fill[4, 3] = textBox4_3.Text.Trim().Equals("") ? false : true;
            fill[4, 4] = textBox4_4.Text.Trim().Equals("") ? false : true;
            fill[4, 5] = textBox4_5.Text.Trim().Equals("") ? false : true;
            fill[4, 6] = textBox4_6.Text.Trim().Equals("") ? false : true;
            fill[4, 7] = textBox4_7.Text.Trim().Equals("") ? false : true;
            fill[4, 8] = textBox4_8.Text.Trim().Equals("") ? false : true;
            fill[4, 9] = textBox4_9.Text.Trim().Equals("") ? false : true;
            fill[5, 1] = textBox5_1.Text.Trim().Equals("") ? false : true;
            fill[5, 2] = textBox5_2.Text.Trim().Equals("") ? false : true;
            fill[5, 3] = textBox5_3.Text.Trim().Equals("") ? false : true;
            fill[5, 4] = textBox5_4.Text.Trim().Equals("") ? false : true;
            fill[5, 5] = textBox5_5.Text.Trim().Equals("") ? false : true;
            fill[5, 6] = textBox5_6.Text.Trim().Equals("") ? false : true;
            fill[5, 7] = textBox5_7.Text.Trim().Equals("") ? false : true;
            fill[5, 8] = textBox5_8.Text.Trim().Equals("") ? false : true;
            fill[5, 9] = textBox5_9.Text.Trim().Equals("") ? false : true;
            fill[6, 1] = textBox6_1.Text.Trim().Equals("") ? false : true;
            fill[6, 2] = textBox6_2.Text.Trim().Equals("") ? false : true;
            fill[6, 3] = textBox6_3.Text.Trim().Equals("") ? false : true;
            fill[6, 4] = textBox6_4.Text.Trim().Equals("") ? false : true;
            fill[6, 5] = textBox6_5.Text.Trim().Equals("") ? false : true;
            fill[6, 6] = textBox6_6.Text.Trim().Equals("") ? false : true;
            fill[6, 7] = textBox6_7.Text.Trim().Equals("") ? false : true;
            fill[6, 8] = textBox6_8.Text.Trim().Equals("") ? false : true;
            fill[6, 9] = textBox6_9.Text.Trim().Equals("") ? false : true;
            fill[7, 1] = textBox7_1.Text.Trim().Equals("") ? false : true;
            fill[7, 2] = textBox7_2.Text.Trim().Equals("") ? false : true;
            fill[7, 3] = textBox7_3.Text.Trim().Equals("") ? false : true;
            fill[7, 4] = textBox7_4.Text.Trim().Equals("") ? false : true;
            fill[7, 5] = textBox7_5.Text.Trim().Equals("") ? false : true;
            fill[7, 6] = textBox7_6.Text.Trim().Equals("") ? false : true;
            fill[7, 7] = textBox7_7.Text.Trim().Equals("") ? false : true;
            fill[7, 8] = textBox7_8.Text.Trim().Equals("") ? false : true;
            fill[7, 9] = textBox7_9.Text.Trim().Equals("") ? false : true;
            fill[8, 1] = textBox8_1.Text.Trim().Equals("") ? false : true;
            fill[8, 2] = textBox8_2.Text.Trim().Equals("") ? false : true;
            fill[8, 3] = textBox8_3.Text.Trim().Equals("") ? false : true;
            fill[8, 4] = textBox8_4.Text.Trim().Equals("") ? false : true;
            fill[8, 5] = textBox8_5.Text.Trim().Equals("") ? false : true;
            fill[8, 6] = textBox8_6.Text.Trim().Equals("") ? false : true;
            fill[8, 7] = textBox8_7.Text.Trim().Equals("") ? false : true;
            fill[8, 8] = textBox8_8.Text.Trim().Equals("") ? false : true;
            fill[8, 9] = textBox8_9.Text.Trim().Equals("") ? false : true;
            fill[9, 1] = textBox9_1.Text.Trim().Equals("") ? false : true;
            fill[9, 2] = textBox9_2.Text.Trim().Equals("") ? false : true;
            fill[9, 3] = textBox9_3.Text.Trim().Equals("") ? false : true;
            fill[9, 4] = textBox9_4.Text.Trim().Equals("") ? false : true;
            fill[9, 5] = textBox9_5.Text.Trim().Equals("") ? false : true;
            fill[9, 6] = textBox9_6.Text.Trim().Equals("") ? false : true;
            fill[9, 7] = textBox9_7.Text.Trim().Equals("") ? false : true;
            fill[9, 8] = textBox9_8.Text.Trim().Equals("") ? false : true;
            fill[9, 9] = textBox9_9.Text.Trim().Equals("") ? false : true;
            return fill;
        }

        public int[,] fillNum(bool[,] fill, int[,] num)
            /*textBoxの内容をnumに格納するメソッド。
             * numに格納される値の意味は下記
             * 0...入力されてない(不明部分)
             * 1-9...入力された数字
             * 10...入力されているが1-9以外かParseに失敗した(あとでエラー出力)
             */
        {
            bool success;
            if (fill[1, 1])
            {
                success = int.TryParse(this.textBox1_1.Text, out num[1, 1]);
                if (!success || (num[1, 1] < 1 || num[1, 1] > 9))
                {
                    num[1, 1] = 10;
                }
            }
            else
            {
                num[1, 1] = 0;
            }
            if (fill[1, 2])
            {
                success = int.TryParse(this.textBox1_2.Text, out num[1, 2]);
                if (!success || (num[1, 2] < 1 || num[1, 2] > 9))
                {
                    num[1, 2] = 10;
                }
            }
            else
            {
                num[1, 2] = 0;
            }
            if (fill[1, 3])
            {
                success = int.TryParse(this.textBox1_3.Text, out num[1, 3]);
                if (!success || (num[1, 3] < 1 || num[1, 3] > 9))
                {
                    num[1, 3] = 10;
                }
            }
            else
            {
                num[1, 3] = 0;
            }
            if (fill[1, 4])
            {
                success = int.TryParse(this.textBox1_4.Text, out num[1, 4]);
                if (!success || (num[1, 4] < 1 || num[1, 4] > 9))
                {
                    num[1, 4] = 10;
                }
            }
            else
            {
                num[1, 4] = 0;
            }
            if (fill[1, 5])
            {
                success = int.TryParse(this.textBox1_5.Text, out num[1, 5]);
                if (!success || (num[1, 5] < 1 || num[1, 5] > 9))
                {
                    num[1, 5] = 10;
                }
            }
            else
            {
                num[1, 5] = 0;
            }
            if (fill[1, 6])
            {
                success = int.TryParse(this.textBox1_6.Text, out num[1, 6]);
                if (!success || (num[1, 6] < 1 || num[1, 6] > 9))
                {
                    num[1, 6] = 10;
                }
            }
            else
            {
                num[1, 6] = 0;
            }
            if (fill[1, 7])
            {
                success = int.TryParse(this.textBox1_7.Text, out num[1, 7]);
                if (!success || (num[1, 7] < 1 || num[1, 7] > 9))
                {
                    num[1, 7] = 10;
                }
            }
            else
            {
                num[1, 7] = 0;
            }
            if (fill[1, 8])
            {
                success = int.TryParse(this.textBox1_8.Text, out num[1, 8]);
                if (!success || (num[1, 8] < 1 || num[1, 8] > 9))
                {
                    num[1, 8] = 10;
                }
            }
            else
            {
                num[1, 8] = 0;
            }
            if (fill[1, 9])
            {
                success = int.TryParse(this.textBox1_9.Text, out num[1, 9]);
                if (!success || (num[1, 9] < 1 || num[1, 9] > 9))
                {
                    num[1, 9] = 10;
                }
            }
            else
            {
                num[1, 9] = 0;
            }
            if (fill[2, 1])
            {
                success = int.TryParse(this.textBox2_1.Text, out num[2, 1]);
                if (!success || (num[2, 1] < 1 || num[2, 1] > 9))
                {
                    num[2, 1] = 10;
                }
            }
            else
            {
                num[2, 1] = 0;
            }
            if (fill[2, 2])
            {
                success = int.TryParse(this.textBox2_2.Text, out num[2, 2]);
                if (!success || (num[2, 2] < 1 || num[2, 2] > 9))
                {
                    num[2, 2] = 10;
                }
            }
            else
            {
                num[2, 2] = 0;
            }
            if (fill[2, 3])
            {
                success = int.TryParse(this.textBox2_3.Text, out num[2, 3]);
                if (!success || (num[2, 3] < 1 || num[2, 3] > 9))
                {
                    num[2, 3] = 10;
                }
            }
            else
            {
                num[2, 3] = 0;
            }
            if (fill[2, 4])
            {
                success = int.TryParse(this.textBox2_4.Text, out num[2, 4]);
                if (!success || (num[2, 4] < 1 || num[2, 4] > 9))
                {
                    num[2, 4] = 10;
                }
            }
            else
            {
                num[2, 4] = 0;
            }
            if (fill[2, 5])
            {
                success = int.TryParse(this.textBox2_5.Text, out num[2, 5]);
                if (!success || (num[2, 5] < 1 || num[2, 5] > 9))
                {
                    num[2, 5] = 10;
                }
            }
            else
            {
                num[2, 5] = 0;
            }
            if (fill[2, 6])
            {
                success = int.TryParse(this.textBox2_6.Text, out num[2, 6]);
                if (!success || (num[2, 6] < 1 || num[2, 6] > 9))
                {
                    num[2, 6] = 10;
                }
            }
            else
            {
                num[2, 6] = 0;
            }
            if (fill[2, 7])
            {
                success = int.TryParse(this.textBox2_7.Text, out num[2, 7]);
                if (!success || (num[2, 7] < 1 || num[2, 7] > 9))
                {
                    num[2, 7] = 10;
                }
            }
            else
            {
                num[2, 7] = 0;
            }
            if (fill[2, 8])
            {
                success = int.TryParse(this.textBox2_8.Text, out num[2, 8]);
                if (!success || (num[2, 8] < 1 || num[2, 8] > 9))
                {
                    num[2, 8] = 10;
                }
            }
            else
            {
                num[2, 8] = 0;
            }
            if (fill[2, 9])
            {
                success = int.TryParse(this.textBox2_9.Text, out num[2, 9]);
                if (!success || (num[2, 9] < 1 || num[2, 9] > 9))
                {
                    num[2, 9] = 10;
                }
            }
            else
            {
                num[2, 9] = 0;
            }
            if (fill[3, 1])
            {
                success = int.TryParse(this.textBox3_1.Text, out num[3, 1]);
                if (!success || (num[3, 1] < 1 || num[3, 1] > 9))
                {
                    num[3, 1] = 10;
                }
            }
            else
            {
                num[3, 1] = 0;
            }
            if (fill[3, 2])
            {
                success = int.TryParse(this.textBox3_2.Text, out num[3, 2]);
                if (!success || (num[3, 2] < 1 || num[3, 2] > 9))
                {
                    num[3, 2] = 10;
                }
            }
            else
            {
                num[3, 2] = 0;
            }
            if (fill[3, 3])
            {
                success = int.TryParse(this.textBox3_3.Text, out num[3, 3]);
                if (!success || (num[3, 3] < 1 || num[3, 3] > 9))
                {
                    num[3, 3] = 10;
                }
            }
            else
            {
                num[3, 3] = 0;
            }
            if (fill[3, 4])
            {
                success = int.TryParse(this.textBox3_4.Text, out num[3, 4]);
                if (!success || (num[3, 4] < 1 || num[3, 4] > 9))
                {
                    num[3, 4] = 10;
                }
            }
            else
            {
                num[3, 4] = 0;
            }
            if (fill[3, 5])
            {
                success = int.TryParse(this.textBox3_5.Text, out num[3, 5]);
                if (!success || (num[3, 5] < 1 || num[3, 5] > 9))
                {
                    num[3, 5] = 10;
                }
            }
            else
            {
                num[3, 5] = 0;
            }
            if (fill[3, 6])
            {
                success = int.TryParse(this.textBox3_6.Text, out num[3, 6]);
                if (!success || (num[3, 6] < 1 || num[3, 6] > 9))
                {
                    num[3, 6] = 10;
                }
            }
            else
            {
                num[3, 6] = 0;
            }
            if (fill[3, 7])
            {
                success = int.TryParse(this.textBox3_7.Text, out num[3, 7]);
                if (!success || (num[3, 7] < 1 || num[3, 7] > 9))
                {
                    num[3, 7] = 10;
                }
            }
            else
            {
                num[3, 7] = 0;
            }
            if (fill[3, 8])
            {
                success = int.TryParse(this.textBox3_8.Text, out num[3, 8]);
                if (!success || (num[3, 8] < 1 || num[3, 8] > 9))
                {
                    num[3, 8] = 10;
                }
            }
            else
            {
                num[3, 8] = 0;
            }
            if (fill[3, 9])
            {
                success = int.TryParse(this.textBox3_9.Text, out num[3, 9]);
                if (!success || (num[3, 9] < 1 || num[3, 9] > 9))
                {
                    num[3, 9] = 10;
                }
            }
            else
            {
                num[3, 9] = 0;
            }
            if (fill[4, 1])
            {
                success = int.TryParse(this.textBox4_1.Text, out num[4, 1]);
                if (!success || (num[4, 1] < 1 || num[4, 1] > 9))
                {
                    num[4, 1] = 10;
                }
            }
            else
            {
                num[4, 1] = 0;
            }
            if (fill[4, 2])
            {
                success = int.TryParse(this.textBox4_2.Text, out num[4, 2]);
                if (!success || (num[4, 2] < 1 || num[4, 2] > 9))
                {
                    num[4, 2] = 10;
                }
            }
            else
            {
                num[4, 2] = 0;
            }
            if (fill[4, 3])
            {
                success = int.TryParse(this.textBox4_3.Text, out num[4, 3]);
                if (!success || (num[4, 3] < 1 || num[4, 3] > 9))
                {
                    num[4, 3] = 10;
                }
            }
            else
            {
                num[4, 3] = 0;
            }
            if (fill[4, 4])
            {
                success = int.TryParse(this.textBox4_4.Text, out num[4, 4]);
                if (!success || (num[4, 4] < 1 || num[4, 4] > 9))
                {
                    num[4, 4] = 10;
                }
            }
            else
            {
                num[4, 4] = 0;
            }
            if (fill[4, 5])
            {
                success = int.TryParse(this.textBox4_5.Text, out num[4, 5]);
                if (!success || (num[4, 5] < 1 || num[4, 5] > 9))
                {
                    num[4, 5] = 10;
                }
            }
            else
            {
                num[4, 5] = 0;
            }
            if (fill[4, 6])
            {
                success = int.TryParse(this.textBox4_6.Text, out num[4, 6]);
                if (!success || (num[4, 6] < 1 || num[4, 6] > 9))
                {
                    num[4, 6] = 10;
                }
            }
            else
            {
                num[4, 6] = 0;
            }
            if (fill[4, 7])
            {
                success = int.TryParse(this.textBox4_7.Text, out num[4, 7]);
                if (!success || (num[4, 7] < 1 || num[4, 7] > 9))
                {
                    num[4, 7] = 10;
                }
            }
            else
            {
                num[4, 7] = 0;
            }
            if (fill[4, 8])
            {
                success = int.TryParse(this.textBox4_8.Text, out num[4, 8]);
                if (!success || (num[4, 8] < 1 || num[4, 8] > 9))
                {
                    num[4, 8] = 10;
                }
            }
            else
            {
                num[4, 8] = 0;
            }
            if (fill[4, 9])
            {
                success = int.TryParse(this.textBox4_9.Text, out num[4, 9]);
                if (!success || (num[4, 9] < 1 || num[4, 9] > 9))
                {
                    num[4, 9] = 10;
                }
            }
            else
            {
                num[4, 9] = 0;
            }
            if (fill[5, 1])
            {
                success = int.TryParse(this.textBox5_1.Text, out num[5, 1]);
                if (!success || (num[5, 1] < 1 || num[5, 1] > 9))
                {
                    num[5, 1] = 10;
                }
            }
            else
            {
                num[5, 1] = 0;
            }
            if (fill[5, 2])
            {
                success = int.TryParse(this.textBox5_2.Text, out num[5, 2]);
                if (!success || (num[5, 2] < 1 || num[5, 2] > 9))
                {
                    num[5, 2] = 10;
                }
            }
            else
            {
                num[5, 2] = 0;
            }
            if (fill[5, 3])
            {
                success = int.TryParse(this.textBox5_3.Text, out num[5, 3]);
                if (!success || (num[5, 3] < 1 || num[5, 3] > 9))
                {
                    num[5, 3] = 10;
                }
            }
            else
            {
                num[5, 3] = 0;
            }
            if (fill[5, 4])
            {
                success = int.TryParse(this.textBox5_4.Text, out num[5, 4]);
                if (!success || (num[5, 4] < 1 || num[5, 4] > 9))
                {
                    num[5, 4] = 10;
                }
            }
            else
            {
                num[5, 4] = 0;
            }
            if (fill[5, 5])
            {
                success = int.TryParse(this.textBox5_5.Text, out num[5, 5]);
                if (!success || (num[5, 5] < 1 || num[5, 5] > 9))
                {
                    num[5, 5] = 10;
                }
            }
            else
            {
                num[5, 5] = 0;
            }
            if (fill[5, 6])
            {
                success = int.TryParse(this.textBox5_6.Text, out num[5, 6]);
                if (!success || (num[5, 6] < 1 || num[5, 6] > 9))
                {
                    num[5, 6] = 10;
                }
            }
            else
            {
                num[5, 6] = 0;
            }
            if (fill[5, 7])
            {
                success = int.TryParse(this.textBox5_7.Text, out num[5, 7]);
                if (!success || (num[5, 7] < 1 || num[5, 7] > 9))
                {
                    num[5, 7] = 10;
                }
            }
            else
            {
                num[5, 7] = 0;
            }
            if (fill[5, 8])
            {
                success = int.TryParse(this.textBox5_8.Text, out num[5, 8]);
                if (!success || (num[5, 8] < 1 || num[5, 8] > 9))
                {
                    num[5, 8] = 10;
                }
            }
            else
            {
                num[5, 8] = 0;
            }
            if (fill[5, 9])
            {
                success = int.TryParse(this.textBox5_9.Text, out num[5, 9]);
                if (!success || (num[5, 9] < 1 || num[5, 9] > 9))
                {
                    num[5, 9] = 10;
                }
            }
            else
            {
                num[5, 9] = 0;
            }
            if (fill[6, 1])
            {
                success = int.TryParse(this.textBox6_1.Text, out num[6, 1]);
                if (!success || (num[6, 1] < 1 || num[6, 1] > 9))
                {
                    num[6, 1] = 10;
                }
            }
            else
            {
                num[6, 1] = 0;
            }
            if (fill[6, 2])
            {
                success = int.TryParse(this.textBox6_2.Text, out num[6, 2]);
                if (!success || (num[6, 2] < 1 || num[6, 2] > 9))
                {
                    num[6, 2] = 10;
                }
            }
            else
            {
                num[6, 2] = 0;
            }
            if (fill[6, 3])
            {
                success = int.TryParse(this.textBox6_3.Text, out num[6, 3]);
                if (!success || (num[6, 3] < 1 || num[6, 3] > 9))
                {
                    num[6, 3] = 10;
                }
            }
            else
            {
                num[6, 3] = 0;
            }
            if (fill[6, 4])
            {
                success = int.TryParse(this.textBox6_4.Text, out num[6, 4]);
                if (!success || (num[6, 4] < 1 || num[6, 4] > 9))
                {
                    num[6, 4] = 10;
                }
            }
            else
            {
                num[6, 4] = 0;
            }
            if (fill[6, 5])
            {
                success = int.TryParse(this.textBox6_5.Text, out num[6, 5]);
                if (!success || (num[6, 5] < 1 || num[6, 5] > 9))
                {
                    num[6, 5] = 10;
                }
            }
            else
            {
                num[6, 5] = 0;
            }
            if (fill[6, 6])
            {
                success = int.TryParse(this.textBox6_6.Text, out num[6, 6]);
                if (!success || (num[6, 6] < 1 || num[6, 6] > 9))
                {
                    num[6, 6] = 10;
                }
            }
            else
            {
                num[6, 6] = 0;
            }
            if (fill[6, 7])
            {
                success = int.TryParse(this.textBox6_7.Text, out num[6, 7]);
                if (!success || (num[6, 7] < 1 || num[6, 7] > 9))
                {
                    num[6, 7] = 10;
                }
            }
            else
            {
                num[6, 7] = 0;
            }
            if (fill[6, 8])
            {
                success = int.TryParse(this.textBox6_8.Text, out num[6, 8]);
                if (!success || (num[6, 8] < 1 || num[6, 8] > 9))
                {
                    num[6, 8] = 10;
                }
            }
            else
            {
                num[6, 8] = 0;
            }
            if (fill[6, 9])
            {
                success = int.TryParse(this.textBox6_9.Text, out num[6, 9]);
                if (!success || (num[6, 9] < 1 || num[6, 9] > 9))
                {
                    num[6, 9] = 10;
                }
            }
            else
            {
                num[6, 9] = 0;
            }
            if (fill[7, 1])
            {
                success = int.TryParse(this.textBox7_1.Text, out num[7, 1]);
                if (!success || (num[7, 1] < 1 || num[7, 1] > 9))
                {
                    num[7, 1] = 10;
                }
            }
            else
            {
                num[7, 1] = 0;
            }
            if (fill[7, 2])
            {
                success = int.TryParse(this.textBox7_2.Text, out num[7, 2]);
                if (!success || (num[7, 2] < 1 || num[7, 2] > 9))
                {
                    num[7, 2] = 10;
                }
            }
            else
            {
                num[7, 2] = 0;
            }
            if (fill[7, 3])
            {
                success = int.TryParse(this.textBox7_3.Text, out num[7, 3]);
                if (!success || (num[7, 3] < 1 || num[7, 3] > 9))
                {
                    num[7, 3] = 10;
                }
            }
            else
            {
                num[7, 3] = 0;
            }
            if (fill[7, 4])
            {
                success = int.TryParse(this.textBox7_4.Text, out num[7, 4]);
                if (!success || (num[7, 4] < 1 || num[7, 4] > 9))
                {
                    num[7, 4] = 10;
                }
            }
            else
            {
                num[7, 4] = 0;
            }
            if (fill[7, 5])
            {
                success = int.TryParse(this.textBox7_5.Text, out num[7, 5]);
                if (!success || (num[7, 5] < 1 || num[7, 5] > 9))
                {
                    num[7, 5] = 10;
                }
            }
            else
            {
                num[7, 5] = 0;
            }
            if (fill[7, 6])
            {
                success = int.TryParse(this.textBox7_6.Text, out num[7, 6]);
                if (!success || (num[7, 6] < 1 || num[7, 6] > 9))
                {
                    num[7, 6] = 10;
                }
            }
            else
            {
                num[7, 6] = 0;
            }
            if (fill[7, 7])
            {
                success = int.TryParse(this.textBox7_7.Text, out num[7, 7]);
                if (!success || (num[7, 7] < 1 || num[7, 7] > 9))
                {
                    num[7, 7] = 10;
                }
            }
            else
            {
                num[7, 7] = 0;
            }
            if (fill[7, 8])
            {
                success = int.TryParse(this.textBox7_8.Text, out num[7, 8]);
                if (!success || (num[7, 8] < 1 || num[7, 8] > 9))
                {
                    num[7, 8] = 10;
                }
            }
            else
            {
                num[7, 8] = 0;
            }
            if (fill[7, 9])
            {
                success = int.TryParse(this.textBox7_9.Text, out num[7, 9]);
                if (!success || (num[7, 9] < 1 || num[7, 9] > 9))
                {
                    num[7, 9] = 10;
                }
            }
            else
            {
                num[7, 9] = 0;
            }
            if (fill[8, 1])
            {
                success = int.TryParse(this.textBox8_1.Text, out num[8, 1]);
                if (!success || (num[8, 1] < 1 || num[8, 1] > 9))
                {
                    num[8, 1] = 10;
                }
            }
            else
            {
                num[8, 1] = 0;
            }
            if (fill[8, 2])
            {
                success = int.TryParse(this.textBox8_2.Text, out num[8, 2]);
                if (!success || (num[8, 2] < 1 || num[8, 2] > 9))
                {
                    num[8, 2] = 10;
                }
            }
            else
            {
                num[8, 2] = 0;
            }
            if (fill[8, 3])
            {
                success = int.TryParse(this.textBox8_3.Text, out num[8, 3]);
                if (!success || (num[8, 3] < 1 || num[8, 3] > 9))
                {
                    num[8, 3] = 10;
                }
            }
            else
            {
                num[8, 3] = 0;
            }
            if (fill[8, 4])
            {
                success = int.TryParse(this.textBox8_4.Text, out num[8, 4]);
                if (!success || (num[8, 4] < 1 || num[8, 4] > 9))
                {
                    num[8, 4] = 10;
                }
            }
            else
            {
                num[8, 4] = 0;
            }
            if (fill[8, 5])
            {
                success = int.TryParse(this.textBox8_5.Text, out num[8, 5]);
                if (!success || (num[8, 5] < 1 || num[8, 5] > 9))
                {
                    num[8, 5] = 10;
                }
            }
            else
            {
                num[8, 5] = 0;
            }
            if (fill[8, 6])
            {
                success = int.TryParse(this.textBox8_6.Text, out num[8, 6]);
                if (!success || (num[8, 6] < 1 || num[8, 6] > 9))
                {
                    num[8, 6] = 10;
                }
            }
            else
            {
                num[8, 6] = 0;
            }
            if (fill[8, 7])
            {
                success = int.TryParse(this.textBox8_7.Text, out num[8, 7]);
                if (!success || (num[8, 7] < 1 || num[8, 7] > 9))
                {
                    num[8, 7] = 10;
                }
            }
            else
            {
                num[8, 7] = 0;
            }
            if (fill[8, 8])
            {
                success = int.TryParse(this.textBox8_8.Text, out num[8, 8]);
                if (!success || (num[8, 8] < 1 || num[8, 8] > 9))
                {
                    num[8, 8] = 10;
                }
            }
            else
            {
                num[8, 8] = 0;
            }
            if (fill[8, 9])
            {
                success = int.TryParse(this.textBox8_9.Text, out num[8, 9]);
                if (!success || (num[8, 9] < 1 || num[8, 9] > 9))
                {
                    num[8, 9] = 10;
                }
            }
            else
            {
                num[8, 9] = 0;
            }
            if (fill[9, 1])
            {
                success = int.TryParse(this.textBox9_1.Text, out num[9, 1]);
                if (!success || (num[9, 1] < 1 || num[9, 1] > 9))
                {
                    num[9, 1] = 10;
                }
            }
            else
            {
                num[9, 1] = 0;
            }
            if (fill[9, 2])
            {
                success = int.TryParse(this.textBox9_2.Text, out num[9, 2]);
                if (!success || (num[9, 2] < 1 || num[9, 2] > 9))
                {
                    num[9, 2] = 10;
                }
            }
            else
            {
                num[9, 2] = 0;
            }
            if (fill[9, 3])
            {
                success = int.TryParse(this.textBox9_3.Text, out num[9, 3]);
                if (!success || (num[9, 3] < 1 || num[9, 3] > 9))
                {
                    num[9, 3] = 10;
                }
            }
            else
            {
                num[9, 3] = 0;
            }
            if (fill[9, 4])
            {
                success = int.TryParse(this.textBox9_4.Text, out num[9, 4]);
                if (!success || (num[9, 4] < 1 || num[9, 4] > 9))
                {
                    num[9, 4] = 10;
                }
            }
            else
            {
                num[9, 4] = 0;
            }
            if (fill[9, 5])
            {
                success = int.TryParse(this.textBox9_5.Text, out num[9, 5]);
                if (!success || (num[9, 5] < 1 || num[9, 5] > 9))
                {
                    num[9, 5] = 10;
                }
            }
            else
            {
                num[9, 5] = 0;
            }
            if (fill[9, 6])
            {
                success = int.TryParse(this.textBox9_6.Text, out num[9, 6]);
                if (!success || (num[9, 6] < 1 || num[9, 6] > 9))
                {
                    num[9, 6] = 10;
                }
            }
            else
            {
                num[9, 6] = 0;
            }
            if (fill[9, 7])
            {
                success = int.TryParse(this.textBox9_7.Text, out num[9, 7]);
                if (!success || (num[9, 7] < 1 || num[9, 7] > 9))
                {
                    num[9, 7] = 10;
                }
            }
            else
            {
                num[9, 7] = 0;
            }
            if (fill[9, 8])
            {
                success = int.TryParse(this.textBox9_8.Text, out num[9, 8]);
                if (!success || (num[9, 8] < 1 || num[9, 8] > 9))
                {
                    num[9, 8] = 10;
                }
            }
            else
            {
                num[9, 8] = 0;
            }
            if (fill[9, 9])
            {
                success = int.TryParse(this.textBox9_9.Text, out num[9, 9]);
                if (!success || (num[9, 9] < 1 || num[9, 9] > 9))
                {
                    num[9, 9] = 10;
                }
            }
            else
            {
                num[9, 9] = 0;
            }
            return num;
        }

        public int[,] solveNumberPlace(int[,] num)
        {
            int[,] oldNum = new int[10, 10];
            Array.Copy(num, oldNum, num.Length);
            bool[,] fillEachFrame = new bool[10, 10];
            //それぞれの3*3のエリアに1-9が入っているかどうかを格納
            for(int i = 1; i <= 9; i++)
            {
                for(int j = 1; j <= 9; j++)
                {
                    if(num[i,j] != 0)
                    {
                        fillEachFrame[i, num[i, j]] = true; //iマスのところの数字をtrue
                    }
                }
            }
            int count = 0;
            int numDecide = 0;
            for(int i = 1; i <= 9; i++)
            {
                for(int j = 1; j <= 9; j++)
                {
                    if(!fillEachFrame[i, j])
                    {
                        numDecide = j;
                        count++;
                    }
                }
                if(count == 1)
                {
                    for(int k = 1; k <= 9; k++)
                    {
                        if (num[i, k] == 0)
                        {
                            Console.WriteLine($"{i} - {k} is {numDecide}!");
                            showNewNum(i, k, numDecide);
                            num[i, k] = numDecide;
                        }
                    }
                }
                count = 0;
                numDecide = 0;
            }
            int spotDecide = 0;
            int frameDecide = 0;
            bool[] restNum = Enumerable.Repeat(true, 10).ToArray();
            restNum[0] = false;
            //横で8こあったら残りの1個を埋める
            for(int i = 0; i < 3; i++)
            {
                for(int j = 0; j < 3; j++)
                {
                    for(int k = 1; k <= 3; k++)
                    {
                        for(int l = 1; l <= 3; l++)
                        {
                            Console.WriteLine($"{i*3+k}, {j * 3 + l} ... {num[i * 3 + k, j * 3 + l]}");
                            if (num[i * 3 + k, j * 3 + l] == 0)
                            {
                                frameDecide = i * 3 + k;
                                spotDecide = j * 3 + l;
                                count++;
                            }
                            else
                            {
                                restNum[num[i * 3 + k, j * 3 + l]] = false;
                            }
                        }
                    }
                    if (count == 1)
                    {
                        Console.WriteLine($"{frameDecide}-{spotDecide}");
                        Console.WriteLine($"rest number is ... {Array.IndexOf(restNum, true)}");
                        num[frameDecide, spotDecide] = Array.IndexOf(restNum, true); 
                    }
                    count = 0;
                    spotDecide = 0;
                    frameDecide = 0;
                    restNum = Enumerable.Repeat(true, 10).ToArray();
                    restNum[0] = false;
                }
            }

            //縦

            for (int i = 1; i <= 3; i++)
            {
                for (int j = 1; j <= 3; j++)
                {
                    for (int k = 0; k < 3; k++)
                    {
                        for (int l = 0; l < 3; l++)
                        {
                            Console.WriteLine($"{i + k * 3}, {j + l * 3} ... {num[i + k * 3, j + l * 3]}");
                            if (num[i + k * 3, j + l * 3] == 0)
                            {
                                frameDecide = i + k * 3;
                                spotDecide = j + l * 3;
                                count++;
                            }
                            else
                            {
                                restNum[num[i + k * 3, j + l * 3]] = false;
                            }
                        }
                    }
                    if (count == 1)
                    {
                        Console.WriteLine($"{frameDecide}-{spotDecide}");
                        Console.WriteLine($"rest number is ... {Array.IndexOf(restNum, true)}");
                        num[frameDecide, spotDecide] = Array.IndexOf(restNum, true);
                    }
                    count = 0;
                    spotDecide = 0;
                    frameDecide = 0;
                    restNum = Enumerable.Repeat(true, 10).ToArray();
                    restNum[0] = false;
                }
            }
            //一周して変わらないなら終わり
            bool same = true;
            for (int i = 1; i <= 9; i++)
            {
                for (int j = 1; j <= 9; j++)
                {
                    if (num[i, j] != oldNum[i, j])
                        same = false;
                }
            }
            Console.WriteLine($"same...{same}");
            if (same)
            {
                return num;
            }

            for (int i = 1; i <= 9; i++)
            {
                for(int j = 1; j <= 9; j++)
                {
                    if (num[i, j] != oldNum[i, j])
                        Console.WriteLine($"num[{i},{j}] ... {num[i,j]}\noldNum[{i},{j}] ... {oldNum[i,j]}");
                }
            }
            Array.Copy(num, oldNum, num.Length);
            //まだ埋めてないところがあれば再帰呼び出し
            for (int i = 1; i <= 9; i++)
            {
                for(int j = 1; j <= 9; j++)
                {
                    if(num[i, j] == 0)
                    {
                        num = solveNumberPlace(num);
                    }
                }
            }
            label1.Text = "error";
            return num;
        }

        public void showNewNum(int frame, int spot, int ans)
        {
            Console.WriteLine("showNewNum loaded");
            Color color = Color.Blue;
            string ansStr = ans.ToString();
            if (frame == 1)
            {
                if (spot == 1)
                {
                    textBox1_1.Text = ansStr;
                    textBox1_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox1_2.Text = ansStr;
                    textBox1_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox1_3.Text = ansStr;
                    textBox1_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox1_4.Text = ansStr;
                    textBox1_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox1_5.Text = ansStr;
                    textBox1_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox1_6.Text = ansStr;
                    textBox1_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox1_7.Text = ansStr;
                    textBox1_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox1_8.Text = ansStr;
                    textBox1_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox1_9.Text = ansStr;
                    textBox1_9.ForeColor = color;
                }
            }
            if (frame == 2)
            {
                if (spot == 1)
                {
                    textBox2_1.Text = ansStr;
                    textBox2_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox2_2.Text = ansStr;
                    textBox2_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox2_3.Text = ansStr;
                    textBox2_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox2_4.Text = ansStr;
                    textBox2_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox2_5.Text = ansStr;
                    textBox2_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox2_6.Text = ansStr;
                    textBox2_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox2_7.Text = ansStr;
                    textBox2_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox2_8.Text = ansStr;
                    textBox2_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox2_9.Text = ansStr;
                    textBox2_9.ForeColor = color;
                }
            }
            if (frame == 3)
            {
                if (spot == 1)
                {
                    textBox3_1.Text = ansStr;
                    textBox3_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox3_2.Text = ansStr;
                    textBox3_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox3_3.Text = ansStr;
                    textBox3_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox3_4.Text = ansStr;
                    textBox3_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox3_5.Text = ansStr;
                    textBox3_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox3_6.Text = ansStr;
                    textBox3_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox3_7.Text = ansStr;
                    textBox3_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox3_8.Text = ansStr;
                    textBox3_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox3_9.Text = ansStr;
                    textBox3_9.ForeColor = color;
                }
            }
            if (frame == 4)
            {
                if (spot == 1)
                {
                    textBox4_1.Text = ansStr;
                    textBox4_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox4_2.Text = ansStr;
                    textBox4_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox4_3.Text = ansStr;
                    textBox4_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox4_4.Text = ansStr;
                    textBox4_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox4_5.Text = ansStr;
                    textBox4_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox4_6.Text = ansStr;
                    textBox4_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox4_7.Text = ansStr;
                    textBox4_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox4_8.Text = ansStr;
                    textBox4_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox4_9.Text = ansStr;
                    textBox4_9.ForeColor = color;
                }
            }
            if (frame == 5)
            {
                if (spot == 1)
                {
                    textBox5_1.Text = ansStr;
                    textBox5_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox5_2.Text = ansStr;
                    textBox5_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox5_3.Text = ansStr;
                    textBox5_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox5_4.Text = ansStr;
                    textBox5_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox5_5.Text = ansStr;
                    textBox5_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox5_6.Text = ansStr;
                    textBox5_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox5_7.Text = ansStr;
                    textBox5_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox5_8.Text = ansStr;
                    textBox5_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox5_9.Text = ansStr;
                    textBox5_9.ForeColor = color;
                }
            }
            if (frame == 6)
            {
                if (spot == 1)
                {
                    textBox6_1.Text = ansStr;
                    textBox6_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox6_2.Text = ansStr;
                    textBox6_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox6_3.Text = ansStr;
                    textBox6_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox6_4.Text = ansStr;
                    textBox6_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox6_5.Text = ansStr;
                    textBox6_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox6_6.Text = ansStr;
                    textBox6_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox6_7.Text = ansStr;
                    textBox6_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox6_8.Text = ansStr;
                    textBox6_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox6_9.Text = ansStr;
                    textBox6_9.ForeColor = color;
                }
            }
            if (frame == 7)
            {
                if (spot == 1)
                {
                    textBox7_1.Text = ansStr;
                    textBox7_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox7_2.Text = ansStr;
                    textBox7_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox7_3.Text = ansStr;
                    textBox7_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox7_4.Text = ansStr;
                    textBox7_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox7_5.Text = ansStr;
                    textBox7_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox7_6.Text = ansStr;
                    textBox7_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox7_7.Text = ansStr;
                    textBox7_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox7_8.Text = ansStr;
                    textBox7_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox7_9.Text = ansStr;
                    textBox7_9.ForeColor = color;
                }
            }
            if (frame == 8)
            {
                if (spot == 1)
                {
                    textBox8_1.Text = ansStr;
                    textBox8_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox8_2.Text = ansStr;
                    textBox8_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox8_3.Text = ansStr;
                    textBox8_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox8_4.Text = ansStr;
                    textBox8_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox8_5.Text = ansStr;
                    textBox8_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox8_6.Text = ansStr;
                    textBox8_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox8_7.Text = ansStr;
                    textBox8_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox8_8.Text = ansStr;
                    textBox8_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox8_9.Text = ansStr;
                    textBox8_9.ForeColor = color;
                }
            }
            if (frame == 9)
            {
                if (spot == 1)
                {
                    textBox9_1.Text = ansStr;
                    textBox9_1.ForeColor = color;
                }
                if (spot == 2)
                {
                    textBox9_2.Text = ansStr;
                    textBox9_2.ForeColor = color;
                }
                if (spot == 3)
                {
                    textBox9_3.Text = ansStr;
                    textBox9_3.ForeColor = color;
                }
                if (spot == 4)
                {
                    textBox9_4.Text = ansStr;
                    textBox9_4.ForeColor = color;
                }
                if (spot == 5)
                {
                    textBox9_5.Text = ansStr;
                    textBox9_5.ForeColor = color;
                }
                if (spot == 6)
                {
                    textBox9_6.Text = ansStr;
                    textBox9_6.ForeColor = color;
                }
                if (spot == 7)
                {
                    textBox9_7.Text = ansStr;
                    textBox9_7.ForeColor = color;
                }
                if (spot == 8)
                {
                    textBox9_8.Text = ansStr;
                    textBox9_8.ForeColor = color;
                }
                if (spot == 9)
                {
                    textBox9_9.Text = ansStr;
                    textBox9_9.ForeColor = color;
                }
            }

        }
    }
}
